!function(){"use strict";try{angular.module("risevision.common.config")}catch(t){angular.module("risevision.common.config",[])}angular.module("risevision.common.config").value("STORE_URL","https://store.risevision.com/").value("STORE_SERVER_URL","https://store-dot-rvaserver2.appspot.com/"),angular.module("risevision.widget.common.subscription-status.config",[]).value("IN_RVA_PATH","/product/productId/?up_id=iframeId&parent=parentUrl&inRVA=true&cid=companyId").value("IN_RVA_ACCOUNT_PATH","/account?up_id=iframeId&parent=parentUrl&inRVA=true").value("PATH_URL","v1/company/companyId/product/status?pc=")}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status",["risevision.common.config","risevision.widget.common.subscription-status.config","risevision.widget.common.subscription-status.service","risevision.widget.common","risevision.common.i18n","ngSanitize"])}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status").directive("appSubscriptionStatus",["$templateCache","subscriptionStatusService","$document","$compile",function(t,o,s,n){return{restrict:"AE",require:"?ngModel",scope:{productId:"@",productCode:"@",companyId:"@",productPrice:"@"},template:t.get("app-subscription-status-template.html"),link:function(t,e,i,a){function r(){t.productCode&&t.productId&&t.companyId&&o.get(t.productCode,t.companyId).then(function(o){o&&(t.subscriptionStatus=o)},function(){})}function c(){if(!d){var o=s.find("body").eq(0),e=angular.element("<div store-modal></div>");e.attr({id:"store-modal",animate:"animate","show-store-modal":"showStoreModal","company-id":"{{companyId}}","product-id":"{{productId}}"});var i=n(e)(t);o.append(i),d=!0}}function u(){if(!p){var o=s.find("body").eq(0),e=angular.element("<div store-account-modal></div>");e.attr({id:"store-account-modal",animate:"animate","show-store-account-modal":"showAccountStoreModal","company-id":"{{companyId}}","product-id":"{{productId}}"});var i=n(e)(t);o.append(i),p=!0}}var d=!1,p=!1;t.subscriptionStatus={status:"N/A",statusCode:"na",subscribed:!1,expiry:null},t.$watch("companyId",function(){r()}),a&&t.$watch("subscriptionStatus",function(t){a.$setViewValue(t)});var l=t.$watch("showStoreModal",function(t){t&&(c(),l())}),m=t.$watch("showStoreAccountModal",function(t){t&&(u(),m())});t.$on("store-dialog-save",function(){r()})}}}]).directive("ngDisableRightClick",function(){return function(t,o){o.bind("contextmenu",function(o){t.$apply(function(){o.preventDefault()})})}})}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status").directive("storeAccountModal",["$templateCache","$location","gadgetsApi","STORE_URL","IN_RVA_ACCOUNT_PATH",function(t,o,s,n,e){return{restrict:"AE",scope:{showStoreAccountModal:"=",productId:"@",companyId:"@"},template:t.get("store-account-modal-template.html"),link:function(t,i){function a(){!t.rpcRegistered&&s&&(t.rpcRegistered=!0,s.rpc.register("rscmd_saveSettings",r),s.rpc.register("rscmd_closeSettings",c),s.rpc.setupReceiver("store-account-modal-frame"))}function r(){t.$emit("store-dialog-save"),c()}function c(){t.$apply(function(){t.showStoreAccountModal=!1})}var u=$(i);t.showStoreAccountModal=!0,t.$watch("showStoreAccountModal",function(s){if(s){a();var i=n+e.replace("productId",t.productId).replace("companyId",t.companyId).replace("iframeId","store-account-modal-frame").replace("parentUrl",encodeURIComponent(o.$$absUrl));u.find("#store-account-modal-frame").attr("src",i)}})}}}])}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status").directive("storeModal",["$templateCache","$location","gadgetsApi","STORE_URL","IN_RVA_PATH",function(t,o,s,n,e){return{restrict:"AE",scope:{showStoreModal:"=",productId:"@",companyId:"@"},template:t.get("store-modal-template.html"),link:function(t,i){function a(){!t.rpcRegistered&&s&&(t.rpcRegistered=!0,s.rpc.register("rscmd_saveSettings",r),s.rpc.register("rscmd_closeSettings",c),s.rpc.setupReceiver("store-modal-frame"))}function r(){t.$emit("store-dialog-save"),c()}function c(){t.$apply(function(){t.showStoreModal=!1})}var u=$(i);t.showStoreModal=!0,t.$watch("showStoreModal",function(s){if(s){a();var i=n+e.replace("productId",t.productId).replace("companyId",t.companyId).replace("iframeId","store-modal-frame").replace("parentUrl",encodeURIComponent(o.$$absUrl));u.find("#store-modal-frame").attr("src",i)}})}}}])}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status").directive("subscriptionStatus",["$templateCache","subscriptionStatusService","$document","$compile","$rootScope",function(t,o,s,n,e){return{restrict:"AE",require:"?ngModel",scope:{productId:"@",productCode:"@",companyId:"@",showStoreModal:"=?"},template:t.get("subscription-status-template.html"),link:function(t,i,a,r){function c(){t.productCode&&t.productId&&t.companyId&&o.get(t.productCode,t.companyId).then(function(o){o&&(t.subscriptionStatus=o)},function(){})}function u(){if(!p){var o=s.find("body").eq(0),e=angular.element("<div store-modal></div>");e.attr({id:"store-modal",animate:"animate","show-store-modal":"showStoreModal","company-id":"{{companyId}}","product-id":"{{productId}}"});var i=n(e)(t);o.append(i),p=!0}}function d(){if(!l){var o=s.find("body").eq(0),e=angular.element("<div store-account-modal></div>");e.attr({id:"store-account-modal",animate:"animate","show-store-account-modal":"showAccountStoreModal","company-id":"{{companyId}}","product-id":"{{productId}}"});var i=n(e)(t);o.append(i),l=!0}}var p=!1,l=!1;t.subscriptionStatus={status:"N/A",statusCode:"na",subscribed:!1,expiry:null},t.$watch("companyId",function(){c()}),e.$on("refreshSubscriptionStatus",function(o,s){(null===s||t.subscriptionStatus.statusCode===s)&&c()}),r&&t.$watch("subscriptionStatus",function(t){r.$setViewValue(t)});var m=t.$watch("showStoreModal",function(t){t&&(u(),m())}),f=t.$watch("showStoreAccountModal",function(t){t&&(d(),f())});t.$on("store-dialog-save",function(){c()})}}}]).filter("to_trusted",["$sce",function(t){return function(o){return t.trustAsHtml(o)}}])}(),angular.module("risevision.widget.common.subscription-status").filter("productTrialDaysToExpiry",["$interpolate","$translate",function(t,o){var s=null,n=null;return o(["subscription-status.expires-today","subscription-status.expires-in"],{days:"{{days}}"}).then(function(o){s=t(o["subscription-status.expires-today"]),n=t(o["subscription-status.expires-in"])}),function(t){var o="";try{var e=864e5,i=new Date(t).getTime()-(new Date).getTime(),a=Math.floor(i/e),r={days:a};o=0===a?null!==s?s(r):"":a>0?null!==n?n(r):"":null!==s?s(r):""}catch(c){o=null!==s?s(r):""}return o}}]),function(){"use strict";angular.module("risevision.widget.common.subscription-status.service",["risevision.common.config","risevision.widget.common.subscription-status.config"]).service("subscriptionStatusService",["$http","$q","STORE_SERVER_URL","PATH_URL",function(t,o,s,n){function e(t,o){return Math.floor((o.getTime()-t.getTime())/r)}var i=["On Trial","Trial Expired","Subscribed","Suspended","Cancelled","Free","Not Subscribed","Product Not Found","Company Not Found","Error"],a=["on-trial","trial-expired","subscribed","suspended","cancelled","free","not-subscribed","product-not-found","company-not-found","error"],r=864e5;this.get=function(r,c){var u=o.defer(),d=s+n.replace("companyId",c)+r;return t.get(d).then(function(t){if(t&&t.data&&t.data.length){var o=t.data[0];o.plural="";var s=i.indexOf(o.status);s>=0&&(o.statusCode=a[s]),""===o.status?(o.status="N/A",o.statusCode="na",o.subscribed=!1):o.subscribed=o.status===i[0]||o.status===i[2]||o.status===i[5]?!0:!1,"not-subscribed"===o.statusCode&&o.trialPeriod&&o.trialPeriod>0&&(o.statusCode="trial-available",o.subscribed=!0),o.expiry&&"on-trial"===o.statusCode&&(o.expiry=new Date(o.expiry),o.expiry instanceof Date&&!isNaN(o.expiry.valueOf())&&(o.expiry=e(new Date,o.expiry)),0===o.expiry?o.plural="-zero":o.expiry>1&&(o.plural="-many")),u.resolve(o)}else u.reject("No response")}),u.promise}}])}(),function(){try{app=angular.module("risevision.widget.common.subscription-status")}catch(t){app=angular.module("risevision.widget.common.subscription-status",[])}app.run(["$templateCache",function(t){"use strict";t.put("app-subscription-status-template.html",'<a id="app-subscription-status" href=""\n  ng-click="showStoreModal = true" class="store-link">\n    <div class="rate">\n      <strong>${{productPrice}}</strong>\n    </div>\n    <div class="subscribe">\n      <strong ng-if="!subscriptionStatus.subscribed"><span translate="subscription-status.get-subscription"></span></strong>\n      <strong ng-if="subscriptionStatus.subscribed"><span translate="subscription-status.continue-to-app"></span></strong>\n    </div>\n</a>\n')}])}(),function(){try{app=angular.module("risevision.widget.common.subscription-status")}catch(t){app=angular.module("risevision.widget.common.subscription-status",[])}app.run(["$templateCache",function(t){"use strict";t.put("store-account-modal-template.html",'<div class="widget" ng-show="showStoreAccountModal">\n  <div class="overlay" ng-click="showStoreAccountModal = false"></div>\n  <div class="settings-center">\n    <div class="wrapper container modal-content">\n      <iframe id="store-account-modal-frame" name="store-account-modal-frame" class="modal-content full-screen-modal">\n        \n      </iframe>\n    </div>\n  </div>\n</div>')}])}(),function(){try{app=angular.module("risevision.widget.common.subscription-status")}catch(t){app=angular.module("risevision.widget.common.subscription-status",[])}app.run(["$templateCache",function(t){"use strict";t.put("store-modal-template.html",'<div class="widget" ng-show="showStoreModal">\n  <div class="overlay" ng-click="showStoreModal = false"></div>\n  <div class="settings-center">\n    <div class="wrapper container modal-content">\n      <iframe id="store-modal-frame" name="store-modal-frame" class="modal-content full-screen-modal">\n        \n      </iframe>\n    </div>\n  </div>\n</div>')}])}(),function(){try{app=angular.module("risevision.widget.common.subscription-status")}catch(t){app=angular.module("risevision.widget.common.subscription-status",[])}app.run(["$templateCache",function(t){"use strict";t.put("subscription-status-template.html","<h3 ng-disable-right-click ng-class=\"{ warning: subscriptionStatus.statusCode === 'on-trial', expired: ['trial-expired', 'suspended', 'cancelled'].indexOf(subscriptionStatus.statusCode) >= 0 }\">\n  <i class=\"fa fa-circle\"></i> \n  <span ng-show=\"subscriptionStatus.statusCode !== 'not-subscribed'\" ng-bind-html=\"'subscription-status.' + subscriptionStatus.statusCode + subscriptionStatus.plural | translate:subscriptionStatus | to_trusted\"></span>\n  \n  <span ng-show=\"subscriptionStatus.statusCode === 'trial-available'\">\n    <a href=\"\" ng-click=\"showStoreModal = true;\"><span translate=\"subscription-status.start-trial\"></span></a>\n  </span>\n  <span ng-show=\"['on-trial', 'trial-expired', 'cancelled', 'not-subscribed'].indexOf(subscriptionStatus.statusCode) >= 0\">\n"+'    <a href="" ng-click="showStoreModal = true;"><span translate="subscription-status.subscribe"></span></a>\n  </span>\n  <span ng-show="[\'suspended\'].indexOf(subscriptionStatus.statusCode) >= 0">\n    <a href="" ng-click="showStoreAccountModal = true;"><span translate="subscription-status.view-account"></span></a>\n  </span>\n</h3>\n')}])}();