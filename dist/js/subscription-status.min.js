!function(){"use strict";try{angular.module("risevision.common.config")}catch(t){angular.module("risevision.common.config",[])}angular.module("risevision.common.config").value("STORE_URL","https://store.risevision.com/").value("STORE_SERVER_URL","https://store-dot-rvaserver2.appspot.com/"),angular.module("risevision.widget.common.subscription-status.config",[]).value("IN_RVA_PATH","?up_id=iframeId&parent=parentUrl#/product/productId/?inRVA&cid=companyId").value("PATH_URL","v1/company/companyId/product/status?pc=")}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status",["risevision.common.config","risevision.widget.common.subscription-status.config","risevision.widget.common.subscription-status.service","risevision.widget.common","risevision.common.i18n"])}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status").directive("appSubscriptionStatus",["$templateCache","subscriptionStatusService","$document","$compile",function(t,s,i,n){return{restrict:"AE",require:"?ngModel",scope:{productId:"@",productCode:"@",companyId:"@",productPrice:"@"},template:t.get("app-subscription-status-template.html"),link:function(t,o,e,a){function r(){t.productCode&&t.productId&&t.companyId&&s.get(t.productCode,t.companyId).then(function(s){s&&(t.subscriptionStatus=s)},function(){})}function c(){if(!u){var s=i.find("body").eq(0),o=angular.element("<div store-modal></div>");o.attr({id:"store-modal",animate:"animate","show-store-modal":"showStoreModal","company-id":"{{companyId}}","product-id":"{{productId}}"});var e=n(o)(t);s.append(e),u=!0}}var u=!1;t.subscriptionStatus={status:"N/A",statusCode:"na",subscribed:!1,expiry:null},t.$watch("companyId",function(){r()}),a&&t.$watch("subscriptionStatus",function(t){a.$setViewValue(t)});var d=t.$watch("showStoreModal",function(t){t&&(c(),d())});t.$on("store-dialog-save",function(){r()})}}}]).directive("ngDisableRightClick",function(){return function(t,s){s.bind("contextmenu",function(s){t.$apply(function(){s.preventDefault()})})}})}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status").directive("storeModal",["$templateCache","$location","gadgetsApi","STORE_URL","IN_RVA_PATH",function(t,s,i,n,o){return{restrict:"AE",scope:{showStoreModal:"=",productId:"@",companyId:"@"},template:t.get("store-modal-template.html"),link:function(t,e){function a(){!t.rpcRegistered&&i&&(t.rpcRegistered=!0,i.rpc.register("rscmd_saveSettings",r),i.rpc.register("rscmd_closeSettings",c),i.rpc.setupReceiver("store-modal-frame"))}function r(){t.$emit("store-dialog-save"),c()}function c(){t.$apply(function(){t.showStoreModal=!1})}var u=$(e);t.showStoreModal=!0,t.$watch("showStoreModal",function(i){if(i){a();var e=n+o.replace("productId",t.productId).replace("companyId",t.companyId).replace("iframeId","store-modal-frame").replace("parentUrl",encodeURIComponent(s.$$absUrl));u.find("#store-modal-frame").attr("src",e)}})}}}])}(),function(){"use strict";angular.module("risevision.widget.common.subscription-status").directive("subscriptionStatus",["$templateCache","subscriptionStatusService","$document","$compile",function(t,s,i,n){return{restrict:"AE",require:"?ngModel",scope:{productId:"@",productCode:"@",companyId:"@",showStoreModal:"="},template:t.get("subscription-status-template.html"),link:function(t,o,e,a){function r(){t.productCode&&t.productId&&t.companyId&&s.get(t.productCode,t.companyId).then(function(s){s&&(t.subscriptionStatus=s)},function(){})}function c(){if(!u){var s=i.find("body").eq(0),o=angular.element("<div store-modal></div>");o.attr({id:"store-modal",animate:"animate","show-store-modal":"showStoreModal","company-id":"{{companyId}}","product-id":"{{productId}}"});var e=n(o)(t);s.append(e),u=!0}}var u=!1;t.subscriptionStatus={status:"N/A",statusCode:"na",subscribed:!1,expiry:null},t.$watch("companyId",function(){r()}),a&&t.$watch("subscriptionStatus",function(t){a.$setViewValue(t)});var d=t.$watch("showStoreModal",function(t){t&&(c(),d())});t.$on("store-dialog-save",function(){r()})}}}])}(),angular.module("risevision.widget.common.subscription-status").filter("productTrialDaysToExpiry",["$interpolate","$translate",function(t,s){var i=null,n=null;return s(["subscription-status.expires-today","subscription-status.expires-in"],{days:"{{days}}"}).then(function(s){i=t(s["subscription-status.expires-today"]),n=t(s["subscription-status.expires-in"])}),function(t){var s="";try{var o=864e5,e=new Date(t).getTime()-(new Date).getTime(),a=Math.floor(e/o),r={days:a};s=0===a?null!==i?i(r):"":a>0?null!==n?n(r):"":null!==i?i(r):""}catch(c){s=null!==i?i(r):""}return s}}]),function(){"use strict";angular.module("risevision.widget.common.subscription-status.service",["risevision.common.config","risevision.widget.common.subscription-status.config"]).service("subscriptionStatusService",["$http","$q","STORE_SERVER_URL","PATH_URL",function(t,s,i,n){var o=["On Trial","Trial Expired","Subscribed","Suspended","Cancelled","Free","Not Subscribed","Product Not Found","Company Not Found","Error"],e=["on-trial","trial-expired","subscribed","suspended","cancelled","free","not-subscribed","product-not-found","company-not-found","error"];this.get=function(a,r){var c=s.defer(),u=i+n.replace("companyId",r)+a;return t.get(u).then(function(t){if(t&&t.data&&t.data.length){var s=t.data[0],i=o.indexOf(s.status);i>=0&&(s.statusCode=e[i]),""===s.status?(s.status="N/A",s.statusCode="na",s.subscribed=!1):s.subscribed=s.status===o[0]||s.status===o[2]||s.status===o[5]?!0:!1,"not-subscribed"===s.statusCode&&s.trialPeriod&&s.trialPeriod>0&&(s.statusCode="trial-available",s.subscribed=!0),c.resolve(s)}else c.reject("No response")}),c.promise}}])}(),function(){try{app=angular.module("risevision.widget.common.subscription-status")}catch(t){app=angular.module("risevision.widget.common.subscription-status",[])}app.run(["$templateCache",function(t){"use strict";t.put("app-subscription-status-template.html",'<a id="app-subscription-status" href=""\n  ng-click="showStoreModal = true" class="store-link">\n    <div class="rate">\n      <strong>${{productPrice}}</strong>\n    </div>\n    <div class="subscribe">\n      <strong ng-if="!subscriptionStatus.subscribed"><span translate="subscription-status.get-subscription"></span></strong>\n      <strong ng-if="subscriptionStatus.subscribed"><span translate="subscription-status.continue-to-app"></span></strong>\n    </div>\n</a>\n')}])}(),function(){try{app=angular.module("risevision.widget.common.subscription-status")}catch(t){app=angular.module("risevision.widget.common.subscription-status",[])}app.run(["$templateCache",function(t){"use strict";t.put("store-modal-template.html",'<div class="widget" ng-show="showStoreModal">\n  <div class="overlay" ng-click="showStoreModal = false"></div>\n  <div class="settings-center">\n    <div class="wrapper container modal-content">\n      <iframe id="store-modal-frame" name="store-modal-frame" class="modal-content full-screen-modal">\n        \n      </iframe>\n    </div>\n  </div>\n</div>')}])}(),function(){try{app=angular.module("risevision.widget.common.subscription-status")}catch(t){app=angular.module("risevision.widget.common.subscription-status",[])}app.run(["$templateCache",function(t){"use strict";t.put("subscription-status-template.html",'<h3 ng-disable-right-click>\n  <a href="" ng-click="showStoreModal = true;">\n      <i class="fa fa-info-circle icon-left"></i>\n  </a>\n  <span class="font-weight-normal">{{\'subscription-status.heading\' | translate}}</span>\n  <span class="hidden-xs font-weight-normal"> |</span>\n  <div class="visible-xs clearfix"></div>\n  \n  <a href="" ng-click="showStoreModal = true;">\n    <span ng-class="{\'product-trial\':subscriptionStatus.subscribed, \'product-expired\':!subscriptionStatus.subscribed}">\n        {{ \'subscription-status.\' + subscriptionStatus.statusCode | translate:subscriptionStatus }}\n        <span ng-if="subscriptionStatus.statusCode === \'on-trial\'"> - {{ subscriptionStatus.expiry | productTrialDaysToExpiry }}</span>\n    </span>\n  </a>\n</h3>\n')}])}();